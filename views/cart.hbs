<head>
  {{!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> --}}

</head>
<h1>{{user.name}}'s cart</h1>
<br>
<br>
<br>
<table class="table">
  <thead>
    <tr>
      {{!-- <th scope="col">#</th> --}}
      <th scope="col">Change amt</th>
      <th scope="col">quantity</th>
      <th scope="col">item</th>
    </tr>
  </thead>
  <tbody>
    {{!-- <tr>
      <th scope="row">1</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr> --}}
   
  
 
{{#each products}}



<tr>
<td>
<div >
        <form action="/mainpage/lbbook/cart/change-product-quantity" method="post" enctype="multipart/form-data">
  <div class="form-row">
    <div class="form-group col-md-6">
      
      <input type="text" class="form-control" name="cartid" value="{{this._id}}" hidden>
    </div>
    <div class="form-group col-md-6">
      
      <input type="text" class="form-control" name="proid" value="{{this.product._id}}" hidden>
    </div>
     <div class="form-group col-md-6">
      <label for="">increment amount</label>
      <input type="text" class="form-control" name="count" value="1">
    </div>
  </div>
    <div class="form-group col-md-4">
      
    </div>
    
  </div>
  <div class="form-group">
    <div class="form-check">   
    
    </div>
  </div>
  <button type="submit" class="btn btn-primary">inc/dec quantity</button>
</form>
</div></td>
<td>{{this.quantity}}</td>
{{!-- <button class="cart-item-count mr-3">+p</button> --}}
<td>

  

    <h6>{{this.product.name}}</h6>
   
    {{!-- <a href="#" class="btn btn-primary"></a> --}}


</td>

</tr>
{{/each}}
 </tbody>
</table>
{{!-- <h3 class="float-right"> Total Price :</h3> --}}
<a class="btn btn-success float-right" href="cart/place-order">PLACE ORDER</a>

<script>

function changeQuantity(cartId,proId,count){
    console.log('im here')

// onclick="changeQuantity('{{this._id}}','{{this.product._id}}',1)"
var xhr = new XMLHttpRequest();

  //   Configure the request
    xhr.open('POST', '/mainpage/lbbook/cart/change-product-quantity', true);
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

    // Set up the callback function for handling the response
    xhr.onload = function() {
      if (xhr.status === 200) {
        console.log('Request succeeded');
         Process the response here if needed
      } else {
        console.log('Request failed');
         Handle the error here if needed
      }
    };

    // Prepare the data to be sent
    //var data = 'cart=cartId,
        //product=proId,
//        count=count'; // Replace with your desired key-value pairs

    // Send the request
    xhr.send(data);


//    jQuery.ajax({
  //    url:'/change-product-quantity',
    //  data:{
      //  cart:cartId,
        //product:proId,
//        count:count
  //    },
    //  method:'post',
      //success:(response)=>{
//        alert(response)
  //    }
    //})
  }
//cartId,proId,count
  //'{{this._id}}','{{this.product._id}}',1
</script>